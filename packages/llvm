package_name=llvm
package_version=3.8.0
tarball_suffix=xz
package_fullname=llvm-3.8.0.src
url=http://llvm.org/releases/3.8.0/llvm-3.8.0.src.tar.xz
build_dependencies=
iscustombuild=1
#haspostinstall=1

custombuild(){
        package_fullname=${package_fullname:-"$package_name-$package_version"}
        package_tarball_name=$package_fullname.tar.$tarball_suffix
        rm $package_tarball_name
        wget $url
        tar xvf $package_tarball_name
	cd $package_fullname
	for p in ../packages/llvm-*.patch; do
		patch -p1 < $p
	done
	cd ..
	mkdir llvm-build
	cd llvm-build
        ../$package_fullname/configure --prefix=/opt/$package_fullname/
        #cd ../$package_fullname/
        make
        make install
        ln -sv /opt/$package_fullname /opt/$package_name
        ln -sv /opt/$package_name/bin/* /bin/
        cd ..
}


#TODO: uncomment when the package works
#postinstall(){
	#rm -r llvm-build
#}
