package_name=perl
package_version=5.22.1
tarball_suffix=xz
url=http://mirrors.tassig.com/perl/perl-5.22.1.tar.xz
build_dependencies=
iscustombuild=1

custombuild(){
	set -e
	package_fullname=$package_name-$package_version
        wget $url
        tar xvf $package_fullname.tar.$tarball_suffix
        cd $package_fullname/
        
        sh Configure -Dprefix=/opt/$package_fullname/ -Dcc=gcc -de 
        
        # a hack to make errno.h available to perl build system # TODO: perl looks for the system headers in /usr/include , fix perl
        mkdir -p /usr/include
        cp `find /opt/gcc* -name errno.h | head -n 1` /usr/include/
        make -j
        rm -r /usr
        
        make install
        ln -sv /opt/$package_fullname /opt/$package_name
        ln -sv /opt/$package_name/bin/* /bin/ || true
        cd ..
}
