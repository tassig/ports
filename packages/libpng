package_name=libpng
package_version=1.6.21
tarball_suffix=xz
url=http://mirrors.tassig.com/libpng/libpng-1.6.21.tar.xz
build_dependencies=
iscustombuild=1

custombuild(){
	package_fullname=$package_name-$package_version
	package_tarball_name=$package_fullname.tar.$tarball_suffix
	wget $url
	tar xvf $package_tarball_name
	rm $package_tarball_name
	cd $package_fullname/
	
	export LDFLAGS="-L/opt/zlib/lib -Wl,-rpath=/opt/zlib/lib"
	export CPPFLAGS=-I/opt/zlib/include
	./configure --prefix=/opt/$package_fullname
	make -j check   # check works fine here
	make install
	ln -sv /opt/$package_fullname /opt/$package_name
	ln -sv /opt/$package_name/bin/* /bin/ || true
	ln -svf /opt/libpng/lib/pkgconfig/* /opt/pkgconf/lib/pkgconfig/
	cd ..
}
