package_name=git
package_version=2.7.3
tarball_suffix=xz
url=http://mirrors.tassig.com/git/
build_dependencies="zlib libressl curl perl gettext expat"
iscustombuild=1

custombuild(){
	package_fullname=$package_name-$package_version
	package_tarball_name=$package_fullname.tar.$tarball_suffix
	wget $url/$package_tarball_name
	tar xvf $package_tarball_name
	cd $package_fullname/
	export LDFLAGS="-L /opt/libressl/lib -Wl,-rpath-link=/opt/libressl/lib"   # fixes a bug in a git executable linkage
	./configure --prefix=/opt/$package_fullname --with-openssl=/opt/libressl --with-zlib=/opt/zlib --with-curl=/opt/curl --with-perl=/bin/perl --with-expat=/opt/expat
	make -j NO_SYS_POLL_H=1 install   # TODO: document this environment variable
	ln -s /opt/$package_fullname /opt/$package_name
	ln -s /opt/$package_name/bin/* /bin/
	cd ..
}
