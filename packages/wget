package_name=wget
package_version=1.17
tarball_suffix=xz
url=http://mirrors.tassig.com/wget/wget-1.17.tar.xz
build_dependencies=
iscustombuild=1

custombuild() {
	wget $url
	tar xvf wget-$package_version.tar.$tarball_suffix
	rm wget-$package_version.tar.$tarball_suffix
	cd wget-$package_version
	
	# TODO: this whole thing looks pretty nasty

#	export ZLIB_CFLAGS="-I/opt/zlib/include"
#	export ZLIB_LIBS="-L/opt/zlib/lib -lz"
#	export OPENSSL_CFLAGS="-I/opt/libressl/include"
#	export OPENSSL_LIBS="-L/opt/libressl/lib -lssl -lcrypto"

	export LDFLAGS="-Wl,-rpath=/opt/libressl/lib -Wl,-rpath=/opt/zlib/lib"
	./configure --prefix=/opt/wget-$package_version --with-ssl=openssl
	make -j -i   # ignoring all errors
#	make -j check
	make -i install
	ln -sv /opt/wget-$package_version /opt/wget
	ln -sfv /opt/wget/bin/* /bin/
	cd ..
}
